(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{351:function(s,t,a){"use strict";a.r(t);var n=a(18),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_2-11-错误处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-11-错误处理"}},[s._v("#")]),s._v(" 2.11 错误处理")]),s._v(" "),t("h2",{attrs:{id:"_2-11-1-基础介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-11-1-基础介绍"}},[s._v("#")]),s._v(" 2.11.1 基础介绍")]),s._v(" "),t("p",[s._v("标准库的error相对比较简单，无法对错误的状态信息进行传递。为此，框架层专门设计了一套错误处理机制，通过errors.NewError()和codes.Convert()可以实现错误在集群服务间随意转换。")]),s._v(" "),t("p",[s._v("为了避免标准库errors与框架库errors上的名字冲突，方便开发者使用。框架库errors也重载了标准库errors的所有函数。因此，无论你是想创建普通的error还是框架设计的error，你都可以使用框架库的errors。")]),s._v(" "),t("h2",{attrs:{id:"_2-11-2-错误接口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-11-2-错误接口"}},[s._v("#")]),s._v(" 2.11.2 错误接口")]),s._v(" "),t("ol",[t("li",[s._v("使用场景")])]),s._v(" "),t("p",[s._v("所有需要返回error的场景，尤其是在集群间传递错误码的场景，都需要使用框架库的errors。")]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("使用方式")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/dobyte/due/v2/errors"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("接口文档")])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://pkg.go.dev/github.com/dobyte/due/v2/errors",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://pkg.go.dev/github.com/dobyte/due/v2/errors"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"_2-11-3-错误码接口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-11-3-错误码接口"}},[s._v("#")]),s._v(" 2.11.3 错误码接口")]),s._v(" "),t("ol",[t("li",[s._v("使用场景")])]),s._v(" "),t("p",[s._v("所有需要在集群间传递错误码的场景。")]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("使用方式")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/dobyte/due/v2/codes"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("接口文档")])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://pkg.go.dev/github.com/dobyte/due/v2/codes",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://pkg.go.dev/github.com/dobyte/due/v2/codes"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"_2-11-4-示例代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-11-4-示例代码"}},[s._v("#")]),s._v(" 2.11.4 示例代码")]),s._v(" "),t("ol",[t("li",[s._v("编写示例")])]),s._v(" "),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" main\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fmt"')]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/dobyte/due/v2/codes"')]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/dobyte/due/v2/errors"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\terr "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" errors"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewError")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("codes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewCode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"not found"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\tcode "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" codes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Convert")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\tfmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tfmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("code"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Code")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tfmt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("code"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Message")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("运行示例")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ go run main.go\ncode error: code "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v(" desc "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" not found\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v("\nnot found\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])])}),[],!1,null,null,null);t.default=r.exports}}]);