(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{352:function(e,t,_){"use strict";_.r(t);var s=_(18),v=Object(s.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"_2-2-协议设计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-协议设计"}},[e._v("#")]),e._v(" 2.2 协议设计")]),e._v(" "),t("h2",{attrs:{id:"_2-2-1-心跳包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-心跳包"}},[e._v("#")]),e._v(" 2.2.1 心跳包")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v(" 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7\n+---------------------------------------------------------------+-+-------------+---------------------------------------------------------------+\n|                              size                             |h|   extcode   |                      heartbeat time (ns)                      |\n+---------------------------------------------------------------+-+-------------+---------------------------------------------------------------+\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("ul",[t("li",[t("p",[e._v("size: 4 bytes")]),e._v(" "),t("ul",[t("li",[e._v("包长度位")]),e._v(" "),t("li",[e._v("长度固定为4字节，且不可修改")])])]),e._v(" "),t("li",[t("p",[e._v("header: 1 bytes")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("包头标识")])]),e._v(" "),t("li",[t("p",[e._v("长度固定为1字节，且不可修改")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("h: 1 bit")]),e._v(" "),t("ul",[t("li",[e._v("心跳标识位")]),e._v(" "),t("li",[e._v("长度固定为1位，且不可修改")]),e._v(" "),t("li",[e._v("心跳包固定为%x1")])])]),e._v(" "),t("li",[t("p",[e._v("extcode: 7 bit")]),e._v(" "),t("ul",[t("li",[e._v("扩展操作码位")]),e._v(" "),t("li",[e._v("长度固定为7位，且不可修改")]),e._v(" "),t("li",[e._v("保留位")])])])])])])]),e._v(" "),t("li",[t("p",[e._v("heartbeat time: 8 bytes")]),e._v(" "),t("ul",[t("li",[e._v("服务端下行心跳时间")]),e._v(" "),t("li",[e._v("上行心跳包无需携带心跳数据，下行心跳包默认携带8 bytes的服务器时间（ns）")]),e._v(" "),t("li",[e._v("此协议数据由"),t("a",{attrs:{href:"#etc"}},[e._v("etc.packet.heartbeatTime")]),e._v("配置参数进行控制")])])])]),e._v(" "),t("h2",{attrs:{id:"_2-2-2-数据包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-数据包"}},[e._v("#")]),e._v(" 2.2.2 数据包")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v(" 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7\n+---------------------------------------------------------------+-+-------------+-------------------------------+-------------------------------+\n|                              size                             |h|   extcode   |             route             |              seq              |\n+---------------------------------------------------------------+-+-------------+-------------------------------+-------------------------------+\n|                                                                message data ...                                                               |\n+-----------------------------------------------------------------------------------------------------------------------------------------------+\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br")])]),t("ul",[t("li",[t("p",[e._v("size: 4 bytes")]),e._v(" "),t("ul",[t("li",[e._v("包长度位")]),e._v(" "),t("li",[e._v("长度固定为4字节，且不可修改")])])]),e._v(" "),t("li",[t("p",[e._v("header: 1 bytes")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("包头标识")])]),e._v(" "),t("li",[t("p",[e._v("长度固定为1字节，且不可修改")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("h: 1 bit")]),e._v(" "),t("ul",[t("li",[e._v("心跳标识位")]),e._v(" "),t("li",[e._v("长度固定为1位，且不可修改")]),e._v(" "),t("li",[e._v("数据包固定为%x0")])])]),e._v(" "),t("li",[t("p",[e._v("extcode: 7 bit")]),e._v(" "),t("ul",[t("li",[e._v("扩展操作码位")]),e._v(" "),t("li",[e._v("长度固定为7位，且不可修改")]),e._v(" "),t("li",[e._v("保留位")])])])])])])]),e._v(" "),t("li",[t("p",[e._v("route: 1 bytes | 2 bytes | 4 bytes")]),e._v(" "),t("ul",[t("li",[e._v("消息路由号")]),e._v(" "),t("li",[e._v("长度默认为2字节，可通过打包器配置"),t("a",{attrs:{href:"#etc"}},[e._v("etc.packet.routeBytes")]),e._v("进行修改")]),e._v(" "),t("li",[e._v("此参数由业务打包器packet.Packer打包，服务器开发者和客户端开发者均要关心此参数")])])]),e._v(" "),t("li",[t("p",[e._v("seq: 0 bytes | 1 bytes | 2 bytes | 4 bytes")]),e._v(" "),t("ul",[t("li",[e._v("消息序列号")]),e._v(" "),t("li",[e._v("长度默认为2字节，可通过打包器配置"),t("a",{attrs:{href:"#etc"}},[e._v("etc.packet.seqBytes")]),e._v("进行修改")]),e._v(" "),t("li",[e._v("可通过将打包器配置"),t("a",{attrs:{href:"#etc"}},[e._v("etc.packet.seqBytes")]),e._v("设置为0来屏蔽使用消息序列号")]),e._v(" "),t("li",[e._v("消息序列号常用于请求/响应模型的消息对儿的确认")]),e._v(" "),t("li",[e._v("此参数由业务打包器packet.Packer打包，服务器开发者和客户端开发者均要关心此参数")])])]),e._v(" "),t("li",[t("p",[e._v("message data: n bytes")]),e._v(" "),t("ul",[t("li",[e._v("消息数据")]),e._v(" "),t("li",[e._v("长度默认为5000字节，可通过打包器配置"),t("a",{attrs:{href:"#etc"}},[e._v("etc.packet.bufferBytes")]),e._v("进行修改")]),e._v(" "),t("li",[e._v("建议较大的消息包通过拆包的方式来进行发送，切勿盲目扩大消息数据的长度")]),e._v(" "),t("li",[e._v("此参数由业务打包器packet.Packer打包，服务器开发者和客户端开发者均要关心此参数")])])])]),e._v(" "),t("h2",{attrs:{id:"_2-2-3-其他语言的实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-其他语言的实现"}},[e._v("#")]),e._v(" 2.2.3 其他语言的实现")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://github.com/dobyte/due-client-ts/blob/master/src/packer.ts",target:"_blank",rel:"noopener noreferrer"}},[e._v("TS打包器"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/dobyte/due-client-shape/blob/master/Packer.cs",target:"_blank",rel:"noopener noreferrer"}},[e._v("C#打包器"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=v.exports}}]);